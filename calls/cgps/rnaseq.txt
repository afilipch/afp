



# differential expression 

python ~/afp/rnaseq/compile_expression.py transcripts/ --order 0h 05h 1h 3h 6h 9h 24h --annotation ~/genomic/coryne/nc_003450_3/transcripts.phages_annotated.gff > differential/compiled.gff
cd differential/
python ~/afp/project_scripts/cgps/rnaseq/split_by_phage.py compiled.gff --outdir .
python ~/afp/rnaseq/differential_multi.py nonphage.gff > nonphage/assigned.tsv
python ~/afp/rnaseq/differential_multi.py phage.gff > phage/assigned.tsv
cd phage
python ~/afp/rnaseq/html_differetnial_genes.py assigned.tsv --annotation ~/genomic/coryne/nc_003450_3/transcripts.phages_annotated.gff --css ~/afp/afbio/html/table.css --js ~/afp/afbio/html/table.js --name phage  --outdir html --ucsc philipchick/coryne --genes_dir .
cd ../nonphage/
python ~/afp/rnaseq/html_differetnial_genes.py assigned.tsv --annotation ~/genomic/coryne/nc_003450_3/transcripts.phages_annotated.gff --css ~/afp/afbio/html/table.css --js ~/afp/afbio/html/table.js --name phage  --outdir html --ucsc philipchick/coryne --genes_dir .
cd ..
python ~/afp/project_scripts/cgps/rnaseq/total_expression_dynamics.py nonphage.gff phage.gff  --plot plots/expression_dynamics_total.png
python ~/afp/project_scripts/cgps/rnaseq/explore_dynamics_trends.py nonphage/assigned.tsv  --knum 8 --outdir plots/trends/nonphage/ --format png
python ~/afp/project_scripts/cgps/rnaseq/explore_dynamics_trends.py phage/assigned.tsv  --knum 8 --outdir plots/trends/phage/ --format png


# TSS differential expression

cd ..
python ~/afp/genomic/tss/assign_mappings_to_tss.py coverage/ --transcripts ~/genomic/coryne/nc_003450_3/transcripts.phages_annotated.gff --order 0h 05h 1h 3h 6h 9h 24h --outdir tss/transcripts/
time python ~/afp/genomic/tss/select_differential_tss.py tss/transcripts/ --transcripts ~/genomic/coryne/nc_003450_3/transcripts.phages_annotated.gff --mindiff 0.2 --minexpr 1000
